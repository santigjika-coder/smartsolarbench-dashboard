<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Smart Park Gauge Dashboard</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-gauge@1.0.0/dist/chartjs-gauge.min.js"></script>

<style>
body{
  background:#0f172a;
  color:white;
  font-family:Arial;
  text-align:center;
}

h1{
  margin:20px;
}

.container{
  display:flex;
  justify-content:center;
  flex-wrap:wrap;
  gap:30px;
}

.card{
  background:#1e293b;
  padding:20px;
  border-radius:15px;
  width:200px;
  height:250px;
  box-shadow:0 0 15px rgba(0,0,0,0.5);
}

.card h3{
  margin-bottom:20px;
}
</style>
</head>
<body>

<h1>ğŸŒ Smart Park Gauge Dashboard</h1>

<div class="container">
  <div class="card">
    <h3>ğŸŒ¡ Temperature</h3>
    <canvas id="tempGauge"></canvas>
  </div>

  <div class="card">
    <h3>ğŸ’§ Humidity</h3>
    <canvas id="humGauge"></canvas>
  </div>

  <div class="card">
    <h3>ğŸ“Š Pressure</h3>
    <canvas id="pressGauge"></canvas>
  </div>

  <div class="card">
    <h3>ğŸ§ª Gas</h3>
    <canvas id="gasGauge"></canvas>
  </div>
</div>

<script>
let tempChart, humChart, pressChart, gasChart;

async function updateGauges(){
  const res = await fetch("https://api.thingspeak.com/channels/3255086/feeds.json?results=1");
  const data = await res.json();
  const last = data.feeds[0];

  const temp = parseFloat(last.field1);
  const hum = parseFloat(last.field2);
  const press = parseFloat(last.field3);
  const gas = parseFloat(last.field4);

  // Helper to create gauge
  function createGauge(ctx, value, min, max, color){
    return new Chart(ctx, {
      type: 'gauge',
      data: {datasets:[{value:value, minValue:min, data:[value], backgroundColor: color} ]},
      options:{
        responsive:true,
        title:{display:false},
        layout:{padding:{bottom:0}},
        needle:{radiusPercentage:2, widthPercentage:3.2, lengthPercentage:80, color:'black'}
      }
    });
  }

  // Temp Gauge
  if(tempChart) tempChart.destroy();
  tempChart = createGauge(document.getElementById('tempGauge'), temp, 0, 50, ['red']);

  // Humidity Gauge
  if(humChart) humChart.destroy();
  humChart = createGauge(document.getElementById('humGauge'), hum, 0, 100, ['blue']);

  // Pressure Gauge
  if(pressChart) pressChart.destroy();
  pressChart = createGauge(document.getElementById('pressGauge'), press, 900, 1100, ['orange']);

  // Gas Gauge
  if(gasChart) gasChart.destroy();
  gasChart = createGauge(document.getElementById('gasGauge'), gas, 0, 100, ['green']);
}

// Load first time
updateGauges();

// Refresh every 15 sek
setInterval(updateGauges,15000);
</script>

</body>
</html>
